<?xml version="1.0" encoding="utf-8"?>
<container xmlns="http://symfony.com/schema/dic/services" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">
    <parameters>
        <parameter key="sulu_media.admin.class">Sulu\Bundle\MediaBundle\Admin\SuluMediaAdmin</parameter>
        <parameter key="sulu_media.admin.content_navigation.class">Sulu\Bundle\MediaBundle\Admin\SuluMediaContentNavigation</parameter>
        <parameter key="sulu_media.media_manager.class">Sulu\Bundle\MediaBundle\Media\Manager\DefaultMediaManager</parameter>
        <parameter key="sulu_media.media_repository.class">Sulu\Bundle\MediaBundle\Entity\MediaRepository</parameter>
        <parameter key="sulu_media.collection_repository.class">Sulu\Bundle\MediaBundle\Entity\CollectionRepository</parameter>
        <parameter key="sulu_media.storage.class">Sulu\Bundle\MediaBundle\Media\Storage\LocalStorage</parameter>
        <parameter key="sulu_media.file_validator.class">Sulu\Bundle\MediaBundle\Media\FileValidator\DefaultFileValidator</parameter>
        <parameter key="sulu_media.thumbnail_manager.class">Sulu\Bundle\MediaBundle\Media\ThumbnailManager\DefaultThumbnailManager</parameter>
        <parameter key="sulu_media.thumbnail_storage">Sulu\Bundle\MediaBundle\Media\ThumbnailStorage\LocalThumbnailStorage</parameter>
        <parameter key="sulu_media.image.converter">Sulu\Bundle\MediaBundle\Media\ImageConverter\ImagineImageConverter</parameter>
        <parameter key="sulu_media.image.command_manager.class">Sulu\Bundle\MediaBundle\Media\ImageConverter\Command\Manager\DefaultCommandManager</parameter>
        <parameter key="sulu_media.image.command.resize.class">Sulu\Bundle\MediaBundle\Media\ImageConverter\Command\ResizeCommand</parameter>
        <parameter key="sulu_media.image.command.scale.class">Sulu\Bundle\MediaBundle\Media\ImageConverter\Command\ScaleCommand</parameter>
    </parameters>
    <services>
        <service id="sulu_media.admin" class="%sulu_media.admin.class%">
            <tag name="sulu.admin"/>
            <argument>%sulu_admin.name%</argument>
        </service>
        <service id="sulu_media.admin.content_navigation" class="%sulu_media.admin.content_navigation.class%"></service>
        <service id="sulu_media.media_repository"
                 class="%sulu_media.media_repository.class%"
                 factory-service="doctrine.orm.entity_manager"
                 factory-method="getRepository">
            <argument>SuluMediaBundle:Media</argument>
        </service>
        <service id="sulu_media.collection_repository"
                 class="%sulu_media.collection_repository.class%"
                 factory-service="doctrine.orm.entity_manager"
                 factory-method="getRepository">
            <argument>SuluMediaBundle:Collection</argument>
        </service>
        <service id="sulu_media.storage" class="%sulu_media.storage.class%">
            <argument>%sulu_media.media.storage.local.path%</argument>
            <argument>%sulu_media.media.storage.local.segments%</argument>
        </service>
        <service id="sulu_media.file_validator" class="%sulu_media.file_validator.class%" />
        <service id="sulu_media.thumbnail_storage" class="%sulu_media.thumbnail_storage%">
            <argument>%sulu_media.thumbnail_storage.path%</argument>
            <argument>%sulu_media.thumbnail_storage.path.url%</argument>
            <argument>%sulu_media.thumbnail_storage.segments%</argument>
        </service>
        <service id="sulu_media.image.converter" class="%sulu_media.image.converter%">
            <argument>%sulu_media.image.formats%</argument>
            <argument type="service" id="sulu_media.image.command_manager" />
        </service>

        <service id="sulu_media.image.command_manager" class="%sulu_media.image.command_manager.class%">
            <argument type="service" id="service_container"/>
            <argument>%sulu_media.image.command.prefix%</argument>
        </service>

        <service id="sulu_media.image.command.resize" class="%sulu_media.image.command.resize.class%" />
        <service id="sulu_media.image.command.scale" class="%sulu_media.image.command.scale.class%" />

        <service id="%sulu_media.image.command.prefix%scale" alias="sulu_media.image.command.scale" />
        <service id="%sulu_media.image.command.prefix%resize" alias="sulu_media.image.command.resize" />

        <service id="sulu_media.media_manager" class="%sulu_media.media_manager.class%">
            <argument type="service" id="sulu_media.media_repository" />
            <argument type="service" id="sulu_media.collection_repository" />
            <argument type="service" id="sulu_security.user_repository" />
            <argument type="service" id="doctrine.orm.entity_manager" />
            <argument type="service" id="sulu_media.storage" />
            <argument type="service" id="sulu_media.thumbnail_storage" />
            <argument type="service" id="sulu_media.file_validator" />
            <argument>%sulu_media.media.max_file_size%</argument>
            <argument>%sulu_media.media.blocked_file_types%</argument>
            <argument>%sulu_media.media.types%</argument>
        </service>

        <service id="sulu_media.thumbnail_manager" class="%sulu_media.thumbnail_manager.class%">
            <argument type="service" id="sulu_media.media_repository" />
            <argument type="service" id="sulu_media.storage" />
            <argument type="service" id="sulu_media.thumbnail_storage" />
            <argument type="service" id="sulu_media.image.converter" />
            <argument>%sulu_media.thumbnail_storage.save_image%</argument>
        </service>
    </services>
</container>
