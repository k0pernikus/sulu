define(["sulumedia/collection/collections"],function(a){"use strict";var b={instanceName:null,url:null,translations:{noMediaSelected:"media-selection.nomedia-selected",addImages:"media-selection.add-images",choose:"media-selection.choose"}},c={skeleton:function(a){return['<div class="media-selection-container form-element">','   <div class="media-selection-header">','       <a href="#" class="fa-plus-circle add" id="',a.ids.addButton,'"></a>','       <div class="position-outer">','           <select class="position" id="',a.ids.position,'">','               <option value="0">left</option>','               <option value="1">right</option>',"           </select>","       </div>",'       <a href="#" class="fa-cog config" id="',a.ids.configButton,'"></a>',"   </div>",'   <div class="media-selection" id="',a.ids.content,'"></div>',"</div>"].join("")},noContent:function(a){return['<div class="no-content">','   <span class="fa-image icon"></span>','   <div class="text">',a,"</div>","</div>"].join("")}},d=function(a){return"#"+this.options.ids[a]},e=function(){this.collections=new a,this.options.ids={addButton:"resource-locator-"+this.options.instanceName+"-add",configButton:"resource-locator-"+this.options.instanceName+"-config",position:"resource-locator-"+this.options.instanceName+"-position",content:"resource-locator-"+this.options.instanceName+"-content",chooseTab:"resource-locator-"+this.options.instanceName+"-choose-tab"},this.sandbox.dom.html(this.$el,c.skeleton(this.options)),this.$content=this.sandbox.dom.find(d.call(this,"content"),this.$el),this.$addButton=this.sandbox.dom.find(d.call(this,"addButton"),this.$el),this.$configButton=this.sandbox.dom.find(d.call(this,"configButton"),this.$el),f.call(this),h.call(this),i.call(this),g.call(this)},f=function(){var a=this.sandbox.translate(this.options.translations.noMediaSelected);this.sandbox.dom.html(this.$content,c.noContent(a))},g=function(){},h=function(){this.sandbox.on("husky.tabs.overlaymedia-selection."+this.options.instanceName+".add.initialized",function(){this.collections.fetch({success:function(a){this.sandbox.start([{name:"grid-group@suluadmin",options:{data:a.toJSON(),el:this.sandbox.dom.find(d.call(this,"chooseTab")),instanceName:"collections",gridUrl:"/admin/api/media?collection=",fieldsUrl:"/admin/api/media/fields",fieldsKey:"mediaFields"}}])}.bind(this)})}.bind(this))},i=function(){var a=j.call(this),b=this.sandbox.dom.createElement("<div/>");this.sandbox.dom.append(this.$el,b),this.sandbox.start([{name:"overlay@husky",options:{triggerEl:this.$addButton,el:b,container:this.$el,instanceName:"media-selection."+this.options.instanceName+".add",skin:"wide",slides:[{title:this.sandbox.translate(this.options.translations.addImages),tabs:[{title:this.sandbox.translate(this.options.translations.choose),data:a}]}]}}])},j=function(){return this.sandbox.dom.createElement('<div id="'+this.options.ids.chooseTab+'" style="max-height: 500px;"/>')};return{historyClosed:!0,initialize:function(){this.options=this.sandbox.util.extend({},b,this.options),e.call(this)}}});