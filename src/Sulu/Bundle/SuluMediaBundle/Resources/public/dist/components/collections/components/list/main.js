define(function(){"use strict";var a={data:{},slideDuration:250},b={openAllKey:"public.open-all",closeAllKey:"public.close-all",elementsKey:"public.elements",toggleAllClass:"toggle-all",slideDownIcon:"play",slideUpIcon:"play-down",collectionsClass:"collections",collectionClass:"collection",collectionSlideClass:"slide",rightContentClass:"rightContent"},c={toggleAll:['<span class="icon-<%= icon %> icon"></span>',"<span><%= text %></span>"].join(""),collection:['<div class="',b.collectionClass,'">','   <div class="head">','       <div class="color" style="background-color: #<%= color %>"></div>','       <div class="icon-<%= icon %> icon"></div>','       <div class="title"><%= title %></div>','       <div class="',b.rightContentClass,'"></div>',"   </div>",'   <div class="',b.collectionSlideClass,'"></div>',"</div>"].join(""),totalElements:['<span class="total"><%= total %> ',b.elementsKey,"</span>"].join("")};return{view:!0,header:{title:"media.collections.title",noBack:!0,breadcrumb:[{title:"navigation.media"},{title:"media.collections.title"}]},initialize:function(){this.options=this.sandbox.util.extend(!0,{},a,this.options),this.toggleAll={$element:null,allOpen:!1},this.collections={},this.render(),this.bindDomEvents()},render:function(){var a,d;this.toggleAll.$element=this.sandbox.dom.createElement('<div class="'+b.toggleAllClass+'"/>'),this.sandbox.dom.html(this.toggleAll.$element,this.sandbox.util.template(c.toggleAll)({icon:b.slideDownIcon,text:b.openAllKey})),this.sandbox.dom.append(this.$el,this.toggleAll.$element),a=this.sandbox.dom.createElement('<div class="'+b.collectionsClass+'"/>'),this.sandbox.util.foreach(this.options.data._embedded,function(e){d=this.sandbox.dom.createElement(this.sandbox.util.template(c.collection)({color:e.color,icon:b.slideDownIcon,title:e.title})),this.sandbox.dom.html(this.sandbox.dom.find("."+b.rightContentClass,d),this.sandbox.util.template(c.totalElements)({total:e.children})),this.sandbox.dom.hide(this.sandbox.dom.find("."+b.collectionSlideClass,d)),this.sandbox.dom.append(a,d),this.collections[e.id]=d,this.bindCollectionDomEvents(e.id,d)}.bind(this)),this.sandbox.dom.append(this.$el,a)},bindCustomEvents:function(){},bindDomEvents:function(){this.sandbox.dom.on(this.toggleAll.$element,"click",this.toggleAllCollections.bind(this))},bindCollectionDomEvents:function(a,b){this.sandbox.dom.on(b,"click",function(){this.toggleCollection(b)}.bind(this))},toggleAllCollections:function(){var a,d;this.toggleAll.allOpen===!0?(a=this.slideUp.bind(this),this.toggleAll.allOpen=!1,this.sandbox.dom.html(this.toggleAll.$element,this.sandbox.util.template(c.toggleAll)({icon:b.slideDownIcon,text:b.openAllKey}))):(a=this.slideDown.bind(this),this.toggleAll.allOpen=!0,this.sandbox.dom.html(this.toggleAll.$element,this.sandbox.util.template(c.toggleAll)({icon:b.slideUpIcon,text:b.closeAllKey})));for(d in this.collections)a(this.collections[d])},toggleCollection:function(a){this.sandbox.dom.is(this.sandbox.dom.find("."+b.collectionSlideClass,a),":visible")?this.slideUp(a):this.slideDown(a)},slideUp:function(a){this.sandbox.dom.stop(this.sandbox.dom.find("."+b.collectionSlideClass,a)),this.sandbox.dom.slideUp(this.sandbox.dom.find("."+b.collectionSlideClass,a),this.options.slideDuration),this.sandbox.dom.removeClass(this.sandbox.dom.find(".head .icon",a),"icon-"+b.slideUpIcon),this.sandbox.dom.prependClass(this.sandbox.dom.find(".head .icon",a),"icon-"+b.slideDownIcon)},slideDown:function(a){this.sandbox.dom.stop(this.sandbox.dom.find("."+b.collectionSlideClass,a)),this.sandbox.dom.slideDown(this.sandbox.dom.find("."+b.collectionSlideClass,a),this.options.slideDuration),this.sandbox.dom.removeClass(this.sandbox.dom.find(".head .icon",a),"icon-"+b.slideDownIcon),this.sandbox.dom.prependClass(this.sandbox.dom.find(".head .icon",a),"icon-"+b.slideUpIcon)}}});