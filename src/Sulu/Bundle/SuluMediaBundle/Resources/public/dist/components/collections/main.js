define(function(){"use strict";var a={allCollectionsUrl:"/admin/api/collections?depth=0",singleCollectionUrl:"/admin/api/collections"},b="sulu.media.collections.",c=function(){return e.call(this,"list")},d=function(){return e.call(this,"collection-changed")},e=function(a){return b+a};return{initialize:function(){if(this.bindCustomEvents(),"list"===this.options.display)this.renderList();else{if("files"!==this.options.display)throw"display type wrong";this.renderFiles()}},bindCustomEvents:function(){this.sandbox.on(c.call(this),function(a){this.sandbox.emit("sulu.router.navigate","media/collections",a?!1:!0,!0)},this),this.sandbox.on("sulu.collection-list.collections.title-changed",function(a,b){this.saveCollection(a,{title:b})}.bind(this)),this.sandbox.on("sulu.collection-list.collections.collection-added",function(a){this.saveNewCollection({title:a})}.bind(this)),this.sandbox.on("sulu.media.collections.files",function(a,b){b=b?b:"files",this.sandbox.emit("sulu.router.navigate","media/collections/edit:"+a+"/"+b,!0,!0)}.bind(this))},saveCollection:function(b,c){this.sandbox.util.save(a.singleCollectionUrl+"/"+b,"PUT",c).done(function(a){this.sandbox.emit(d.call(this),a)}.bind(this))},saveNewCollection:function(b){this.sandbox.util.save(a.singleCollectionUrl,"POST",b).done(function(a){this.sandbox.emit(d.call(this),a)}.bind(this))},renderList:function(){var b=this.sandbox.dom.createElement('<div id="collections-list-container"/>');this.html(b),this.sandbox.util.load(a.allCollectionsUrl).then(function(a){this.sandbox.start([{name:"collections/components/list@sulumedia",options:{el:b,data:a}}])}.bind(this))},renderFiles:function(){var b=this.sandbox.dom.createElement('<div id="collection-files-container"/>');this.html(b),this.sandbox.util.load(a.singleCollectionUrl+"/"+this.options.id).then(function(a){this.sandbox.start([{name:"collections/components/files@sulumedia",options:{el:b,activeTab:this.options.content,data:a}}])}.bind(this))}}});