<form id="contact-form" class="form-horizontal">
    <input type="hidden" data-mapper-property="id"/>

    <div class="grid">

        {% block static %}

        {% endblock %}

        {% block contact %}
            <div id="contact-edit-form">
                <div class="pos-rel">
                    <h2 class="divider"><%=translate('contact.contacts.title')%></h2>
        <span id="contact-options-dropdown" class="options-dropdown-container">
            <a href="javascript:void(0)" class="contact-options-toggle options-toggle"><span class="icon-cogwheel"/></a>
        </span>
                </div>

                <div class="grid-row small" data-type="collection" data-mapper-property='[{"data":"addresses","tpl":"address-tpl"}]'>
                    <script type="text/template" id="address-tpl">
                        <div class="grid-col-12 floating">
                            <~ var uid = _.uniqueId('address_') ~>
                            <div class="form-group">
                                <label>
                                    <%=translate('public.address')%>
                                    <span class="label-container">
                                        <span class="type-value" data-form="true" data-mapper-property="addressType" data-type="label" data-type-label="name" data-type-id="id" data-id="{{ defaultAddressType.id }}"></span>
                                        <%= translate('{{ defaultAddressType.name }}') %>
                                    </span>
                                </label>
                                <div class="address-row">
                                    <input type="hidden" data-mapper-property="id" class="id-value"/>
                                    <span data-mapper-property="street" data-form="true"></span>
                                    <span data-mapper-property="number" data-form="true"></span>
                                    <span data-mapper-property="addition" data-form="true"></span>
                                    <~ if (typeof zip !== 'undefined') print(',') ~>
                                    <span data-mapper-property="zip" data-form="true"></span>
                                    <span data-mapper-property="city" data-form="true"></span>
                                    <~ if (typeof state !== 'undefined') print(',') ~>
                                    <span data-mapper-property="state" data-form="true"></span>
                                    <~ if (typeof state !== 'country') print(',') ~>
                                    <span data-mapper-property="country" data-form="true" data-type="readonly-select" data-type-id-property="id" data-type-output-property="name" data-type-data="{{ countries | json_encode() }}"></span>
                                </div>
                            </div>
                        </div>
                    </script>
                </div>
                <div class="grid-row small" id="contact-fields" data-type="collection" data-mapper-property='[{"data":"emails","tpl":"email-tpl"},{"data":"phones","tpl":"phone-tpl"},{"data":"urls","tpl":"url-tpl"}]'>
                    <script type="text/template" id="email-tpl">
                        <div class="grid-col-6 floating">
                            <~ var uid = _.uniqueId('email_') ~>
                            <div class="form-group">
                                <label for="<~= uid ~>">
                                    <%=translate('public.email')%>
                                    <span class="label-container">
                                        <span class="type-value" data-form="true" data-mapper-property="emailType" data-type="label" data-type-label="name" data-type-id="id" data-id="{{ defaultEmailType.id }}">
                                            <%=translate('{{ defaultEmailType.name }}')%>
                                        </span>
                                    </span>
                                </label>
                                <div>
                                    <input type="hidden" data-mapper-property="id" class="id-value"/>
                                    <input id="<~= uid ~>" type="text" class="form-element email-value" data-type="email" data-mapper-property="email">
                                </div>
                            </div>
                        </div>
                    </script>
                    <script type="text/template" id="phone-tpl">
                        <div class="grid-col-6 floating">
                            <~ var uid = _.uniqueId('phone_') ~>
                            <div class="form-group">
                                <label for="<~= uid ~>">
                                    <%=translate('public.phone')%>
                                    <span class="label-container">
                                        <span class="type-value" data-form="true" data-mapper-property="phoneType" data-type="label" data-type-label="name" data-type-id="id" data-id="{{ defaultPhoneType.id }}">
                                        <%= translate('{{ defaultPhoneType.name }}') %>
                                        </span>
                                    </span>
                                </label>
                                <div>
                                    <input type="hidden" data-mapper-property="id" class="id-value"/>
                                    <input id="<~= uid ~>" type="text" class="form-element phone-value" data-mapper-property="phone">
                                </div>
                            </div>
                        </div>
                    </script>
                    <script type="text/template" id="url-tpl">
                        <div class="grid-col-6 floating">
                            <~ var uid = _.uniqueId('url_') ~>
                            <div class="form-group">
                                <label for="<~= uid ~>">
                                    <%= translate('contact.accounts.website') %>
                                    <span class="label-container">
                                        <span class="type-value" data-form="true" data-mapper-property="urlType" data-type="label" data-type-label="name" data-type-id="id" data-id="{{ defaultUrlType.id }}">
                                        <%= translate('{{ defaultPhoneType.name }}') %>
                                        </span>
                                    </span>
                                </label>
                                <div>
                                    <input type="hidden" data-mapper-property="id" class="id-value"/>
                                    <input id="<~= uid ~>" type="text" class="form-element" data-type="url" data-mapper-property="url"/>
                                </div>
                            </div>
                        </div>
                    </script>
                </div>

                <div class="grid-row small" data-type="collection" data-mapper-property='{"data":"notes","tpl":"note-tpl"}'>
                    <script type="text/template" id="note-tpl">
                        <div class="grid-col-12 floating">
                            <~ var uid = _.uniqueId('note_') ~>
                            <div class="form-group">
                                <label class="top" for="<~= uid ~>"><%= translate('public.note') %></label>
                                <div>
                                    <input type="hidden" data-mapper-property="id" class="id-value"/>
                                    <textarea id="<~= uid ~>" data-form="true" class="form-element" data-mapper-property="value" > </textarea>
                                </div>
                            </div>
                        </div>
                    </script>
                </div>
            </div>
        {% endblock %}
    </div>


</form>

{% block dialog %}
    <div id="dialog"></div>
{% endblock %}

{% block data %}
    <script type="text/javascript">
        (function() {
            var defaults = {
                emailType: {
                    'id': {{ defaultEmailType.id }},
                    'name': '{{ defaultEmailType.name }}'
                },
                phoneType: {
                    'id': {{ defaultPhoneType.id }},
                    'name': '{{ defaultPhoneType.name }}'
                },
                addressType: {
                    'id': {{ defaultAddressType.id }},
                    'name': '{{ defaultAddressType.name }}'
                },
                urlType: {
                    'id': {{ defaultUrlType.id }},
                    'name': '{{ defaultUrlType.name }}'
                },
                {#faxType: {#}
                    {#'id': {{ defaultFaxType.id }},#}
                    {#'name': '{{ defaultFaxType.name }}'#}
                {#},#}
                country: {
                    'id': {{ defaultCountry.id }},
                    'name': '{{ defaultCountry.name }}'
                }
            };

            App.emit('sulu.contacts.set-defaults', defaults);
        })();
    </script>
{% endblock %}
