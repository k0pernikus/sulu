define(["mvc/relationalstore"],function(a){"use strict";var b=function(){this.sandbox.on("husky.datagrid.item.click",function(a){this.sandbox.emit("sulu.contacts.contact.load",a)},this),this.sandbox.on("sulu.list-toolbar.delete",function(){this.sandbox.emit("husky.datagrid.items.get-selected",function(a){this.sandbox.emit("sulu.contacts.accounts.delete",a)}.bind(this))},this)},c=function(){return[{id:"settings",icon:"gear",items:[{title:this.sandbox.translate("list-toolbar.column-options"),disabled:!1,callback:function(){var a;this.sandbox.dom.append("body",'<div id="column-options-overlay" />'),this.sandbox.start([{name:"column-options@husky",options:{el:"#column-options-overlay",data:this.sandbox.sulu.getUserSetting(this.options.columnOptions.key),hidden:!1,instanceName:this.options.instanceName,trigger:".toggle"}}]),a=this.options.instanceName?this.options.instanceName+".":"",this.sandbox.once("husky.column-options."+a+"saved",function(a){this.sandbox.sulu.saveUserSetting(this.options.columnOptions.key,a,this.options.columnOptions.url)}.bind(this))}.bind(this)}]}]};return{view:!0,templates:["/admin/contact/template/contact/list"],initialize:function(){this.render(),b.call(this)},render:function(){a.reset(),this.sandbox.emit("sulu.",this.options.account),this.sandbox.dom.html(this.$el,this.renderTemplate("/admin/contact/template/contact/list")),this.sandbox.sulu.initListToolbarAndList.call(this,"accountsContactsFields","/admin/api/contacts/fields",{el:this.$find("#list-toolbar-container"),instanceName:"contacts",inHeader:!0,template:c},{el:this.sandbox.dom.find("#people-list",this.$el),url:"/admin/api/accounts/"+this.options.data.id+"/contacts?flat=true",searchInstanceName:"contacts",viewOptions:{table:{fullWidth:!0,selectItem:!1,removeRow:!1}}})}}});