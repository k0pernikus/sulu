define(["app-config"],function(a){"use strict";var b=function(){this.sandbox.on("husky.datagrid.item.click",function(a){this.sandbox.emit("sulu.contacts.accounts.load",a)},this),this.sandbox.on("sulu.list-toolbar.delete",function(){this.sandbox.emit("husky.datagrid.items.get-selected",function(a){this.sandbox.emit("sulu.contacts.accounts.delete",a)}.bind(this))},this)},c=function(){var b,c,d=0,e=a.getSection("sulu-contact").accountTypes;return this.options.data.id?(b=this.options.data.type,c="id"):this.options.accountTypeName?(b=this.options.accountTypeName,c="name"):(b=0,c="id"),this.sandbox.util.foreach(e,function(a){return a[c]===b?(d=a,this.options.data.type=a.id,!1):void 0}.bind(this)),d},d=function(){return[{id:"settings",icon:"cogwheel",items:[{title:this.sandbox.translate("list-toolbar.column-options"),disabled:!1,callback:function(){var a;this.sandbox.dom.append("body",'<div id="column-options-overlay" />'),this.sandbox.start([{name:"column-options@husky",options:{el:"#column-options-overlay",data:this.sandbox.sulu.getUserSetting(this.options.columnOptions.key),hidden:!1,instanceName:this.options.instanceName,trigger:".toggle"}}]),a=this.options.instanceName?this.options.instanceName+".":"",this.sandbox.once("husky.column-options."+a+"saved",function(a){this.sandbox.sulu.saveUserSetting(this.options.columnOptions.key,a,this.options.columnOptions.url)}.bind(this))}.bind(this)}]}]},e=function(a){var b=this.sandbox.translate(this.options.data.name),c=[{title:"navigation.contacts"},{title:"contact.accounts.title",event:"sulu.contacts.accounts.list"},{title:a.translation+" #"+this.options.data.id}];this.sandbox.emit("sulu.header.set-title",b),this.sandbox.emit("sulu.header.set-breadcrumb",c)};return{view:!0,templates:["/admin/contact/template/contact/list"],initialize:function(){this.render(),b.call(this),this.accountType=c.call(this),e.call(this,this.accountType)},render:function(){this.sandbox.emit("sulu.",this.options.account),this.sandbox.dom.html(this.$el,this.renderTemplate("/admin/contact/template/contact/list")),this.sandbox.sulu.initListToolbarAndList.call(this,"accountsContactsFields","/admin/api/contacts/fields",{el:this.$find("#list-toolbar-container"),instanceName:"contacts",inHeader:!0,template:d},{el:this.sandbox.dom.find("#people-list",this.$el),url:"/admin/api/accounts/"+this.options.data.id+"/contacts?flat=true",fullWidth:!0,selectItem:{type:"checkbox"},removeRow:!1,searchInstanceName:"contacts",sortable:!0})}}});