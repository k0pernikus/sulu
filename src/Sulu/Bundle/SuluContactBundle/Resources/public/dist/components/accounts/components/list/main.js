define(["mvc/relationalstore","app-config"],function(a,b){"use strict";var c=function(){this.sandbox.on("husky.datagrid.item.click",function(a){this.sandbox.emit("sulu.contacts.accounts.load",a)},this),this.sandbox.on("sulu.list-toolbar.delete",function(){this.sandbox.emit("husky.datagrid.items.get-selected",function(a){this.sandbox.emit("sulu.contacts.accounts.delete",a)}.bind(this))},this),this.sandbox.on("sulu.list-toolbar.add",function(){this.sandbox.emit("sulu.contacts.accounts.new")},this)},d=function(a){var b=null;"all"!==a.id&&(b=a.id),this.sandbox.emit("husky.datagrid.url.update",{type:b}),this.sandbox.emit("sulu.contacts.accounts.list",a.name,!0)},e=function(a){this.sandbox.emit("sulu.contacts.accounts.new",a)};return{view:!0,templates:["/admin/contact/template/account/list"],initialize:function(){this.render(),c.call(this)},render:function(){a.reset(),this.sandbox.dom.html(this.$el,this.renderTemplate("/admin/contact/template/account/list"));var c,f,g,h,i="",j=b.getSection("sulu-contact").accountTypes;if(this.options.accountType){for(f=0,g=j.length;++f<g;)if(j[f].name===this.options.accountType){h=j[f];break}i+="&type="+h.id}for(c=[{id:"all",title:this.sandbox.translate("public.all")}],f=0,g=j.length;++f<g;)c.push({id:j[f].id,name:j[f].name,title:this.sandbox.translate(j[f].translation)});this.sandbox.start([{name:"tabs@husky",options:{el:"#filter-tabs",callback:d.bind(this),preselect:h?h.id+1:!1,preselector:"position",data:{items:c}}}]),this.sandbox.sulu.initListToolbarAndList.call(this,"accountsFields","/admin/api/accounts/fields",{el:"#list-toolbar-container",instanceName:"accounts",parentTemplate:"default",template:function(){return[{id:"add",icon:"circle-plus","class":"highlight",title:this.sandbox.translate("sulu.list-toolbar.add"),items:[{id:"add-basic",title:this.sandbox.translate("contact.account.add-basic"),callback:e.bind(this,"basic")},{id:"add-lead",title:this.sandbox.translate("contact.account.add-lead"),callback:e.bind(this,"lead")},{id:"add-customer",title:this.sandbox.translate("contact.account.add-customer"),callback:e.bind(this,"customer")},{id:"add-supplier",title:this.sandbox.translate("contact.account.add-supplier"),callback:e.bind(this,"supplier")}],callback:function(){this.sandbox.emit("sulu.list-toolbar.add")}.bind(this)}]}},{el:this.sandbox.dom.find("#companies-list",this.$el),url:"/admin/api/accounts?flat=true"+i,sortable:!0,selectItem:{type:"checkbox"}})}}});