define(["app-config"],function(a){"use strict";var b=1,c=2,d=4;return{view:!0,layout:{changeNothing:!0},initialize:function(){this.sandbox.emit("husky.toolbar.header.item.disable","template",!1),this.load(),this.bindCustomEvents()},startComponents:function(){var a=this.sandbox.dom.data("#shadow_base_language_select","languages"),b=[],c=null;void 0!==this.data.enabledShadowLanguages[this.options.language]&&(c=this.data.enabledShadowLanguages[this.options.language]),0===a.length?b.push({id:"",name:"no languages",disabled:!0}):this.sandbox.util.each(this.data.concreteLanguages,function(a,d){if(this.options.language!==d){var e=!1;c===d&&(e=!0),b.push({id:d,name:d,disabled:e})}}.bind(this));var d=this.data.shadowBaseLanguage;void 0===b[d]&&b.length>0&&(d=b[0].id),this.sandbox.start([{name:"select@husky",options:{el:"#shadow_base_language_select",instanceName:"settings",multipleSelect:!1,defaultLabel:"",data:b,preSelectedElements:[d]}}])},bindCustomEvents:function(){this.sandbox.on("sulu.header.toolbar.save",function(){this.submit()},this),this.sandbox.on("sulu.content.contents.saved",function(){window.location.reload()},this);var a=function(){this.sandbox.emit("sulu.content.contents.set-header-bar",!1)}.bind(this);this.sandbox.on("husky.select.nav-contexts.selected.item",a.bind(this)),this.sandbox.on("husky.select.nav-contexts.deselected.item",a.bind(this)),this.sandbox.on("husky.select.settings.selected.item",function(){this.sandbox.emit("sulu.content.changed"),this.sandbox.emit("sulu.content.contents.set-header-bar",!1)}.bind(this))},_updateTabVisibilityForShadowCheckbox:function(){var a=this.sandbox.dom.find("#shadow_on_checkbox")[0],b=a.checked?"hide":"show";this.sandbox.util.each(["content","excerpt","seo"],function(a,c){this.sandbox.emit("husky.tabs.header.item."+b,"tab-"+c)}.bind(this)),this.sandbox.util.each(["show-in-navigation-container","settings-content-form-container"],function(a,c){"hide"===b?this.sandbox.dom.find("#"+c).hide():this.sandbox.dom.find("#"+c).show()}.bind(this))},load:function(){this.sandbox.emit("sulu.content.contents.get-data",function(a){this.render(a)}.bind(this))},render:function(a){this.data=a,require(["text!/admin/content/template/content/settings.html?webspaceKey="+this.options.webspace],function(a){this.sandbox.dom.html(this.$el,this.sandbox.util.template(a,{translate:this.sandbox.translate})),this.setData(this.data),this.listenForChange(),this.startComponents(),this.sandbox.dom.on("#shadow_on_checkbox","click",function(){this._updateTabVisibilityForShadowCheckbox()}.bind(this)),this._updateTabVisibilityForShadowCheckbox()}.bind(this))},setData:function(a){var c=parseInt(a.nodeType);c===b?this.sandbox.dom.attr("#content-node-type","checked",!0):c===d?this.sandbox.dom.attr("#internal-link-node-type","checked",!0):c===d&&this.sandbox.dom.attr("#external-link-node-type","checked",!0),this.sandbox.on("husky.select.nav-contexts.initialize",function(){this.sandbox.dom.data("#nav-contexts","selection",a.navContexts),this.sandbox.dom.data("#nav-contexts","selectionValues",a.navContexts),$("#nav-contexts").trigger("data-changed")}.bind(this)),a.shadowOn&&this.sandbox.dom.attr("#shadow_on_checkbox","checked",!0)},listenForChange:function(){this.sandbox.dom.on(this.$el,"keyup change",function(){this.setHeaderBar(!1)}.bind(this),".trigger-save-button")},setHeaderBar:function(a){this.sandbox.emit("sulu.content.contents.set-header-bar",a)},submit:function(){this.sandbox.logger.log("save Model");var b={};b.navContexts=this.sandbox.dom.data("#nav-contexts","selection"),b.nodeType=parseInt(this.sandbox.dom.val('input[name="nodeType"]:checked')),b.shadowOn=this.sandbox.dom.prop("#shadow_on_checkbox","checked"),b.shadowBaseLanguage=this.sandbox.dom.data("#shadow_base_language_select","selectionValues")[0],this.data=this.sandbox.util.extend(!0,{},this.data,b),this.sandbox.emit("sulu.content.contents.save",this.data,b.nodeType===c?"internal-link":b.nodeType===d?"external-link":a.getSection("sulu-content").defaultTemplate)}}});